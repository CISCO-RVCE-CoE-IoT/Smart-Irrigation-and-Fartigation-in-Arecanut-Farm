{"ast":null,"code":"var _jsxFileName = \"/home/mcalab3/Desktop/contributor/Smart-Irrigation-and-Fartigation-in-Arecanut-Farm/client/src/pages/User/Components/Farmer/Map.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport L from \"leaflet\";\nimport campass from '../Images/campass.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Map = ({\n  data\n}) => {\n  _s();\n  const mapRef = useRef(null);\n  const [legendItems, setLegendItems] = useState([]);\n  useEffect(() => {\n    if (mapRef.current) {\n      const map = L.map(mapRef.current).setView([16.22525, 74.8424], 25);\n      L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n        maxZoom: 26,\n        minZoom: 2\n      }).addTo(map);\n\n      // Color mappings\n      const colorMap = {\n        farmland: \"green\",\n        valve: \"orange\",\n        moisture: \"blue\",\n        npk: \"red\"\n      };\n\n      // Handle farmland polygon\n      const farmlandCoordinates = data.farmlocation.farm_loc.map(loc => {\n        const [lat, lon] = loc.split(\",\").map(Number);\n        return [lat, lon];\n      });\n      const farmlandLayer = L.polygon(farmlandCoordinates, {\n        color: colorMap.farmland\n      }).addTo(map);\n      farmlandLayer.bindPopup(\"Farmland Area\");\n\n      // Fit map to the farmland bounds\n      const farmlandBounds = L.latLngBounds(farmlandCoordinates);\n      map.fitBounds(farmlandBounds);\n\n      // Unique types for legend\n      const uniqueTypes = new Set();\n\n      // Handle sensor locations with moisture data\n      data.sensorlocation.forEach(sensor => {\n        uniqueTypes.add(sensor.device_name);\n        const [lat, lon] = sensor.device_location.split(\",\").map(Number);\n        const color = colorMap[sensor.device_name] || \"gray\";\n\n        // Find related moisture data\n        const moistureData = data.moisturedata.find(m => m.section_device_id === sensor.section_device_id);\n        const popupContent = moistureData ? `${sensor.device_name}: ${sensor.section_id}<br/>Moisture: ${moistureData.moisture_value}%<br/>Timestamp: ${new Date(moistureData.timestamp).toLocaleString()}` : `${sensor.device_name}: ${sensor.section_id}`;\n        L.circleMarker([lat, lon], {\n          radius: sensor.device_name === \"moisture\" ? 5 : 8,\n          fillColor: color,\n          color: \"black\",\n          fillOpacity: 1,\n          stroke: sensor.device_name === \"moisture\" ? false : true\n        }).addTo(map).bindPopup(popupContent);\n      });\n\n      // Handle farm device locations\n      data.farmdevicelocation.forEach(device => {\n        uniqueTypes.add(device.device_name);\n        const [lat, lon] = device.device_location.split(\",\").map(Number);\n        const color = colorMap[device.device_name] || \"gray\";\n        L.circleMarker([lat, lon], {\n          radius: 6,\n          fillColor: color,\n          color: color,\n          fillOpacity: 1,\n          weight: 1\n        }).addTo(map).bindPopup(`${device.device_name}: ${device.farm_device_id}`);\n      });\n\n      // Legend items\n      const legendData = Array.from(uniqueTypes).map(type => ({\n        type,\n        color: colorMap[type] || \"gray\"\n      }));\n      setLegendItems(legendData);\n\n      // Cleanup on unmount\n      return () => {\n        map.remove();\n      };\n    }\n  }, [data]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: \"relative\",\n      overflow: 'hidden'\n    },\n    className: \"borderring\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapRef,\n      style: {\n        width: \"100%\",\n        height: \"445px\",\n        scale: \"1.25\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"absolute\",\n        top: \"10px\",\n        right: \"10px\",\n        backgroundColor: \"white\",\n        padding: \"6px\",\n        borderRadius: \"5px\",\n        boxShadow: \"0 0 5px rgba(0,0,0,0.5)\",\n        zIndex: 10\n      },\n      children: [legendItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          alignItems: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: \"10px\",\n            height: \"10px\",\n            backgroundColor: item.color,\n            marginRight: \"5px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            fontSize: '13px'\n          },\n          children: item.type.charAt(0).toUpperCase() + item.type.slice(1)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 25\n        }, this)]\n      }, item.type, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 21\n      }, this)), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: campass,\n        width: 80,\n        alt: \"Compass\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 9\n  }, this);\n};\n_s(Map, \"5rTJLjj8uCt4A74gnoRlyaXVi0Y=\");\n_c = Map;\nexport default Map;\nvar _c;\n$RefreshReg$(_c, \"Map\");","map":{"version":3,"names":["React","useEffect","useRef","useState","L","campass","jsxDEV","_jsxDEV","Map","data","_s","mapRef","legendItems","setLegendItems","current","map","setView","tileLayer","maxZoom","minZoom","addTo","colorMap","farmland","valve","moisture","npk","farmlandCoordinates","farmlocation","farm_loc","loc","lat","lon","split","Number","farmlandLayer","polygon","color","bindPopup","farmlandBounds","latLngBounds","fitBounds","uniqueTypes","Set","sensorlocation","forEach","sensor","add","device_name","device_location","moistureData","moisturedata","find","m","section_device_id","popupContent","section_id","moisture_value","Date","timestamp","toLocaleString","circleMarker","radius","fillColor","fillOpacity","stroke","farmdevicelocation","device","weight","farm_device_id","legendData","Array","from","type","remove","style","position","overflow","className","children","ref","width","height","scale","fileName","_jsxFileName","lineNumber","columnNumber","top","right","backgroundColor","padding","borderRadius","boxShadow","zIndex","item","display","alignItems","marginRight","fontSize","charAt","toUpperCase","slice","src","alt","_c","$RefreshReg$"],"sources":["/home/mcalab3/Desktop/contributor/Smart-Irrigation-and-Fartigation-in-Arecanut-Farm/client/src/pages/User/Components/Farmer/Map.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport L from \"leaflet\";\nimport campass from '../Images/campass.png';\n\nconst Map = ({ data }) => {\n    const mapRef = useRef(null);\n    const [legendItems, setLegendItems] = useState([]);\n\n    useEffect(() => {\n        if (mapRef.current) {\n            const map = L.map(mapRef.current).setView([16.22525, 74.8424], 25);\n\n            L.tileLayer(\n                \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n                {\n                    maxZoom: 26,\n                    minZoom: 2,\n                }\n            ).addTo(map);\n\n            // Color mappings\n            const colorMap = {\n                farmland: \"green\",\n                valve: \"orange\",\n                moisture: \"blue\",\n                npk: \"red\",\n            };\n\n            // Handle farmland polygon\n            const farmlandCoordinates = data.farmlocation.farm_loc.map((loc) => {\n                const [lat, lon] = loc.split(\",\").map(Number);\n                return [lat, lon];\n            });\n            const farmlandLayer = L.polygon(farmlandCoordinates, {\n                color: colorMap.farmland,\n            }).addTo(map);\n            farmlandLayer.bindPopup(\"Farmland Area\");\n\n            // Fit map to the farmland bounds\n            const farmlandBounds = L.latLngBounds(farmlandCoordinates);\n            map.fitBounds(farmlandBounds);\n\n            // Unique types for legend\n            const uniqueTypes = new Set();\n\n            // Handle sensor locations with moisture data\n            data.sensorlocation.forEach((sensor) => {\n                uniqueTypes.add(sensor.device_name);\n                const [lat, lon] = sensor.device_location.split(\",\").map(Number);\n                const color = colorMap[sensor.device_name] || \"gray\";\n                \n                // Find related moisture data\n                const moistureData = data.moisturedata.find(m => m.section_device_id === sensor.section_device_id);\n                const popupContent = moistureData\n                    ? `${sensor.device_name}: ${sensor.section_id}<br/>Moisture: ${moistureData.moisture_value}%<br/>Timestamp: ${new Date(moistureData.timestamp).toLocaleString()}`\n                    : `${sensor.device_name}: ${sensor.section_id}`;\n\n                L.circleMarker([lat, lon], {\n                    radius: sensor.device_name === \"moisture\" ? 5 : 8,\n                    fillColor: color,\n                    color: \"black\",\n                    fillOpacity: 1,\n                    stroke: sensor.device_name === \"moisture\" ? false : true,\n                }).addTo(map).bindPopup(popupContent);\n            });\n\n            // Handle farm device locations\n            data.farmdevicelocation.forEach((device) => {\n                uniqueTypes.add(device.device_name);\n                const [lat, lon] = device.device_location.split(\",\").map(Number);\n                const color = colorMap[device.device_name] || \"gray\";\n\n                L.circleMarker([lat, lon], {\n                    radius: 6,\n                    fillColor: color,\n                    color: color,\n                    fillOpacity: 1,\n                    weight: 1,\n                }).addTo(map).bindPopup(`${device.device_name}: ${device.farm_device_id}`);\n            });\n\n            // Legend items\n            const legendData = Array.from(uniqueTypes).map((type) => ({\n                type,\n                color: colorMap[type] || \"gray\",\n            }));\n            setLegendItems(legendData);\n\n            // Cleanup on unmount\n            return () => {\n                map.remove();\n            };\n        }\n    }, [data]);\n\n    return (\n        <div style={{ position: \"relative\" ,overflow:'hidden'}} className=\"borderring\">\n            <div ref={mapRef} style={{ width: \"100%\", height: \"445px\", scale: \"1.25\" }}></div>\n            <div style={{\n                position: \"absolute\",\n                top: \"10px\",\n                right: \"10px\",\n                backgroundColor: \"white\",\n                padding: \"6px\",\n                borderRadius: \"5px\",\n                boxShadow: \"0 0 5px rgba(0,0,0,0.5)\",\n                zIndex: 10,\n            }}>\n                {legendItems.map((item) => (\n                    <div key={item.type} style={{ display: \"flex\", alignItems: \"center\" }}>\n                        <div style={{ width: \"10px\", height: \"10px\", backgroundColor: item.color, marginRight: \"5px\" }}></div>\n                        <span style={{ fontSize: '13px' }}>{item.type.charAt(0).toUpperCase() + item.type.slice(1)}</span>\n                    </div>\n                ))}\n                <img src={campass} width={80} alt=\"Compass\"/>\n            </div>\n        </div>\n    );\n};\n\nexport default Map;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}