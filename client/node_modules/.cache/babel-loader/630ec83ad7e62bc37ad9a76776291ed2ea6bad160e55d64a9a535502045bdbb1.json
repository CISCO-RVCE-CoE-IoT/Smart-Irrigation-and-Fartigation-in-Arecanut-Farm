{"ast":null,"code":"var _jsxFileName = \"/home/mcalab3/Desktop/contributor/Smart-Irrigation-and-Fartigation-in-Arecanut-Farm/client/src/pages/User/Components/Farmer/Map.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport L from \"leaflet\";\nimport campass from '../Images/campass.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Map = ({\n  data\n}) => {\n  _s();\n  const mapRef = useRef(null);\n  const [legendItems, setLegendItems] = useState([]);\n  useEffect(() => {\n    if (mapRef.current && data.location_coordinates) {\n      var _data$location_coordi, _data$location_coordi2, _data$location_coordi3;\n      const map = L.map(mapRef.current).setView([16.22525, 74.8424], 16); // Adjust zoom level to 16 for better map visibility\n\n      L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n        maxZoom: 26,\n        minZoom: 2\n      }).addTo(map);\n      const colorMap = {\n        farmland: \"green\",\n        valve: \"orange\",\n        moisture: \"blue\",\n        npk: \"red\"\n      };\n\n      // Parse farmland coordinates and create polygon\n      const farmlandCoordinates = ((_data$location_coordi = data.location_coordinates.farm_coordinates) === null || _data$location_coordi === void 0 ? void 0 : _data$location_coordi.map(loc => {\n        const [lat, lon] = loc.split(\",\").map(Number);\n        return [lat, lon];\n      })) || [];\n      if (farmlandCoordinates.length > 0) {\n        const farmlandLayer = L.polygon(farmlandCoordinates, {\n          color: colorMap.farmland\n        }).addTo(map);\n        farmlandLayer.bindPopup(\"Farmland Area\");\n        const farmlandBounds = L.latLngBounds(farmlandCoordinates);\n        map.fitBounds(farmlandBounds);\n      }\n      const uniqueTypes = new Set();\n\n      // Create markers for section devices\n      (_data$location_coordi2 = data.location_coordinates.section_device) === null || _data$location_coordi2 === void 0 ? void 0 : _data$location_coordi2.forEach(sensor => {\n        uniqueTypes.add(sensor.device_name);\n        const [lat, lon] = sensor.device_location.split(\",\").map(Number);\n        const color = colorMap[sensor.device_name] || \"gray\";\n        const moistureData = data.device_values.moisture_device_value.find(m => m.section_device_id === sensor.section_device_id);\n        const popupContent = moistureData ? `${sensor.device_name}: ${sensor.section_name}<br/>Moisture: ${moistureData.moisture_value}%<br/>Timestamp: ${new Date(moistureData.timestamp).toLocaleString()}` : `${sensor.device_name}: ${sensor.section_name}`;\n        L.circleMarker([lat, lon], {\n          radius: sensor.device_name === \"moisture\" ? 5 : 8,\n          fillColor: color,\n          color: \"black\",\n          fillOpacity: 1,\n          stroke: sensor.device_name === \"moisture\" ? false : true\n        }).addTo(map).bindPopup(popupContent);\n      });\n\n      // Create markers for farm devices\n      (_data$location_coordi3 = data.location_coordinates.farm_device) === null || _data$location_coordi3 === void 0 ? void 0 : _data$location_coordi3.forEach(device => {\n        uniqueTypes.add(device.device_name);\n        const [lat, lon] = device.device_location.split(\",\").map(Number);\n        const color = colorMap[device.device_name] || \"gray\";\n        L.circleMarker([lat, lon], {\n          radius: 6,\n          fillColor: color,\n          color: color,\n          fillOpacity: 1,\n          weight: 1\n        }).addTo(map).bindPopup(`${device.device_name}: ${device.farm_device_id}`);\n      });\n\n      // Set up legend\n      const legendData = Array.from(uniqueTypes).map(type => ({\n        type,\n        color: colorMap[type] || \"gray\"\n      }));\n      setLegendItems(legendData);\n      return () => {\n        map.remove();\n      };\n    }\n  }, [data]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: \"relative\",\n      overflow: 'hidden'\n    },\n    className: \"borderring\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapRef,\n      style: {\n        width: \"100%\",\n        height: \"445px\",\n        scale: \"1.25\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"absolute\",\n        top: \"10px\",\n        right: \"10px\",\n        backgroundColor: \"white\",\n        padding: \"6px\",\n        borderRadius: \"5px\",\n        boxShadow: \"0 0 5px rgba(0,0,0,0.5)\",\n        zIndex: 10\n      },\n      children: [legendItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          alignItems: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: \"10px\",\n            height: \"10px\",\n            backgroundColor: item.color,\n            marginRight: \"5px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            fontSize: '13px'\n          },\n          children: item.type.charAt(0).toUpperCase() + item.type.slice(1)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 25\n        }, this)]\n      }, item.type, true, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 21\n      }, this)), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: campass,\n        width: 80,\n        alt: \"Compass\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 9\n  }, this);\n};\n_s(Map, \"5rTJLjj8uCt4A74gnoRlyaXVi0Y=\");\n_c = Map;\nexport default Map;\nvar _c;\n$RefreshReg$(_c, \"Map\");","map":{"version":3,"names":["React","useEffect","useRef","useState","L","campass","jsxDEV","_jsxDEV","Map","data","_s","mapRef","legendItems","setLegendItems","current","location_coordinates","_data$location_coordi","_data$location_coordi2","_data$location_coordi3","map","setView","tileLayer","maxZoom","minZoom","addTo","colorMap","farmland","valve","moisture","npk","farmlandCoordinates","farm_coordinates","loc","lat","lon","split","Number","length","farmlandLayer","polygon","color","bindPopup","farmlandBounds","latLngBounds","fitBounds","uniqueTypes","Set","section_device","forEach","sensor","add","device_name","device_location","moistureData","device_values","moisture_device_value","find","m","section_device_id","popupContent","section_name","moisture_value","Date","timestamp","toLocaleString","circleMarker","radius","fillColor","fillOpacity","stroke","farm_device","device","weight","farm_device_id","legendData","Array","from","type","remove","style","position","overflow","className","children","ref","width","height","scale","fileName","_jsxFileName","lineNumber","columnNumber","top","right","backgroundColor","padding","borderRadius","boxShadow","zIndex","item","display","alignItems","marginRight","fontSize","charAt","toUpperCase","slice","src","alt","_c","$RefreshReg$"],"sources":["/home/mcalab3/Desktop/contributor/Smart-Irrigation-and-Fartigation-in-Arecanut-Farm/client/src/pages/User/Components/Farmer/Map.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport L from \"leaflet\";\nimport campass from '../Images/campass.png';\n\nconst Map = ({ data }) => {\n    const mapRef = useRef(null);\n    const [legendItems, setLegendItems] = useState([]);\n\n    useEffect(() => {\n        if (mapRef.current && data.location_coordinates) {\n            const map = L.map(mapRef.current).setView([16.22525, 74.8424], 16); // Adjust zoom level to 16 for better map visibility\n\n            L.tileLayer(\n                \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n                {\n                    maxZoom: 26,\n                    minZoom: 2,\n                }\n            ).addTo(map);\n\n            const colorMap = {\n                farmland: \"green\",\n                valve: \"orange\",\n                moisture: \"blue\",\n                npk: \"red\",\n            };\n\n            // Parse farmland coordinates and create polygon\n            const farmlandCoordinates = data.location_coordinates.farm_coordinates?.map((loc) => {\n                const [lat, lon] = loc.split(\",\").map(Number);\n                return [lat, lon];\n            }) || [];\n\n            if (farmlandCoordinates.length > 0) {\n                const farmlandLayer = L.polygon(farmlandCoordinates, {\n                    color: colorMap.farmland,\n                }).addTo(map);\n                farmlandLayer.bindPopup(\"Farmland Area\");\n\n                const farmlandBounds = L.latLngBounds(farmlandCoordinates);\n                map.fitBounds(farmlandBounds);\n            }\n\n            const uniqueTypes = new Set();\n\n            // Create markers for section devices\n            data.location_coordinates.section_device?.forEach((sensor) => {\n                uniqueTypes.add(sensor.device_name);\n                const [lat, lon] = sensor.device_location.split(\",\").map(Number);\n                const color = colorMap[sensor.device_name] || \"gray\";\n                \n                const moistureData = data.device_values.moisture_device_value.find(m => m.section_device_id === sensor.section_device_id);\n                const popupContent = moistureData\n                    ? `${sensor.device_name}: ${sensor.section_name}<br/>Moisture: ${moistureData.moisture_value}%<br/>Timestamp: ${new Date(moistureData.timestamp).toLocaleString()}`\n                    : `${sensor.device_name}: ${sensor.section_name}`;\n\n                L.circleMarker([lat, lon], {\n                    radius: sensor.device_name === \"moisture\" ? 5 : 8,\n                    fillColor: color,\n                    color: \"black\",\n                    fillOpacity: 1,\n                    stroke: sensor.device_name === \"moisture\" ? false : true,\n                }).addTo(map).bindPopup(popupContent);\n            });\n\n            // Create markers for farm devices\n            data.location_coordinates.farm_device?.forEach((device) => {\n                uniqueTypes.add(device.device_name);\n                const [lat, lon] = device.device_location.split(\",\").map(Number);\n                const color = colorMap[device.device_name] || \"gray\";\n\n                L.circleMarker([lat, lon], {\n                    radius: 6,\n                    fillColor: color,\n                    color: color,\n                    fillOpacity: 1,\n                    weight: 1,\n                }).addTo(map).bindPopup(`${device.device_name}: ${device.farm_device_id}`);\n            });\n\n            // Set up legend\n            const legendData = Array.from(uniqueTypes).map((type) => ({\n                type,\n                color: colorMap[type] || \"gray\",\n            }));\n            setLegendItems(legendData);\n\n            return () => {\n                map.remove();\n            };\n        }\n    }, [data]);\n\n    return (\n        <div style={{ position: \"relative\", overflow: 'hidden' }} className=\"borderring\">\n            <div ref={mapRef} style={{ width: \"100%\", height: \"445px\", scale: \"1.25\" }}></div>\n            <div style={{\n                position: \"absolute\",\n                top: \"10px\",\n                right: \"10px\",\n                backgroundColor: \"white\",\n                padding: \"6px\",\n                borderRadius: \"5px\",\n                boxShadow: \"0 0 5px rgba(0,0,0,0.5)\",\n                zIndex: 10,\n            }}>\n                {legendItems.map((item) => (\n                    <div key={item.type} style={{ display: \"flex\", alignItems: \"center\" }}>\n                        <div style={{ width: \"10px\", height: \"10px\", backgroundColor: item.color, marginRight: \"5px\" }}></div>\n                        <span style={{ fontSize: '13px' }}>{item.type.charAt(0).toUpperCase() + item.type.slice(1)}</span>\n                    </div>\n                ))}\n                <img src={campass} width={80} alt=\"Compass\" />\n            </div>\n        </div>\n    );\n};\n\nexport default Map;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}